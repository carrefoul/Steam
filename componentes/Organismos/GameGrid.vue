<template>
  <div class="gamegallery">
    <component :is="textSize" class="text">
      {{ buttonText }}
    </component>
    <div class="game-grid">
      <game-card v-for="game in games" :key="game.id" :gameData="game" />
    </div>
  </div>

</template>

<script>
import axios from 'axios';
import GameCard from '../Moleculas/GameCard.vue';

const apiKey = 'c320afcffae4417e9b8004ba91f1950b'; 

export default {
  components: {
    GameCard,
  },
  props: {

    buttonText: {
      type: String,
      default: 'TÍTULOS POPULARES'
    },
    textSize: {
      type: String,
      default: 'h1',
    },
  },
  data() {
    return {
      games: [],
    };
  },
  async mounted() {
    await this.fetchGames();
  },
  methods: {
    async fetchGames() {
      const apiUrl = `https://api.rawg.io/api/games?key=${apiKey}&page_size=20`;

      try {
        const response = await axios.get(apiUrl);
        const games = response.data.results;

        const gameDetailsPromises = games.map(async (game) => {
          const gameDetailsUrl = `https://api.rawg.io/api/games/${game.id}?key=${apiKey}`;
          const gameDetailsResponse = await axios.get(gameDetailsUrl);
          return {
            ...game,
            description: gameDetailsResponse.data.description_raw || 'No description available'
          };
        });

        this.games = await Promise.all(gameDetailsPromises);
      } catch (error) {
        console.error('Error fetching game data:', error);
      }
    },
  },
};
</script>

<style scoped>
.gamegallery {
  display: flex;
  flex-direction: column;
  justify-content: space-between;
  gap: 15px;
  margin: 20px;
}

.game-grid {
  display: grid;
  padding: 0px;
  grid-template-columns: repeat(5, 1fr);
  gap: 10px;
  width: 100%;
  box-sizing: border-box;
}
</style>
